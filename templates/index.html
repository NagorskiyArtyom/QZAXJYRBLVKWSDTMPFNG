<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Match - –ò–∑—É—á–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-left">
            <a href="/" class="home-btn">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="menu-btn" id="menuBtn">‚ò∞ –ú–µ–Ω—é</button>
        </div>
        <div class="navbar-center">Match</div>
        <div class="navbar-right">
            <input type="text" class="search-bar" placeholder="–ü–æ–∏—Å–∫...">
            {% if user %}
                <button class="avatar-btn" id="avatarBtn" style="{% if user.avatar %}background-image: url('{{ url_for('uploaded_file', filename=user.avatar) }}');{% endif %}">
                    {% if not user.avatar %}üë§{% endif %}
                </button>
            {% else %}
                <button class="auth-btn" id="authBtn">
                    <span class="auth-text">–í–æ–π—Ç–∏</span>
                </button>
            {% endif %}
        </div>
    </nav>

    {% if user %}
        <div class="sections-container hidden" id="sectionsContainer">
            <div class="section" data-section="tests">
                <h3>–ú–æ–∏ —Ç–µ—Å—Ç—ã</h3>
                <p>–°–ø–∏—Å–æ–∫ –≤–∞—à–∏—Ö —Ç–µ—Å—Ç–æ–≤</p>
            </div>
            <div class="section-divider"></div>
            <div class="section" data-section="favorites">
                <h3>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h3>
                <p>–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã</p>
            </div>
            <div class="section-divider"></div>
            <div class="section" data-section="history">
                <h3>–ò—Å—Ç–æ—Ä–∏—è</h3>
                <p>–í–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è</p>
            </div>
        </div>

        <div id="mainContent" class="section-content active">
            <div class="content-box">
                <h2>–í—Å–µ —Ç–µ—Å—Ç—ã</h2>
                <div class="tests-container" id="userAllTestsContainer"></div>
            </div>
        </div>

        <div id="testsContent" class="section-content">
            <div class="content-box">
                <h2>–ú–æ–∏ —Ç–µ—Å—Ç—ã</h2>
                <div class="tests-container" id="userTestsContainer"></div>
                <div class="add-test-container hidden" id="addTestContainer">
                    <div class="test-header">
                        <input type="text" id="testName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞" class="test-name-input">
                        <div class="error-message" id="testNameError"></div>
                    </div>
                    <div class="cards-form-container">
                        <div class="card-form">
                            <input type="text" class="card-front-input" placeholder="–ü–µ—Ä–≤–∞—è —á–∞—Å—Ç—å —Ñ—Ä–∞–∑—ã">
                            <input type="text" class="card-back-input" placeholder="–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å —Ñ—Ä–∞–∑—ã">
                            <button class="add-card-btn">–î–æ–±–∞–≤–∏—Ç—å —Ñ—Ä–∞–∑—É</button>
                        </div>
                        <div class="cards-preview" id="cardsPreview"></div>
                    </div>
                    <div class="test-actions">
                        <button class="cancel-test-btn">–û—Ç–º–µ–Ω–∞</button>
                        <button class="create-test-btn">–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç</button>
                    </div>
                </div>
                <button class="add-test-btn" id="addTestBtn">+</button>
            </div>
        </div>

        <div id="favoritesContent" class="section-content">
            <div class="content-box">
                <h2>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h2>
                <div class="tests-container" id="userFavoritesContainer">
                    <p style="text-align: center; color: #666;">–ü–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤</p>
                </div>
            </div>
        </div>

        <div id="historyContent" class="section-content">
            <div class="content-box">
                <h2>–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π</h2>
                <p style="text-align: center; color: #666;">–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–∫–∞ –ø—É—Å—Ç–∞</p>
            </div>
        </div>

        <div class="modal hidden" id="avatarModal">
            <div class="avatar-modal">
                <div class="avatar-modal-header">
                    <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
                    <button class="avatar-modal-close" id="closeAvatarBtn">&times;</button>
                </div>
                <div class="avatar-modal-body">
                    <div class="avatar-preview-container">
                        <div class="avatar-preview" id="avatarPreview" style="{% if user.avatar %}background-image: url('{{ url_for('uploaded_file', filename=user.avatar) }}');{% endif %}">
                            {% if not user.avatar %}<span class="default-avatar-icon">üë§</span>{% endif %}
                        </div>
                    </div>
                    <form method="POST" action="{{ url_for('upload_avatar') }}" enctype="multipart/form-data" class="avatar-upload-form">
                        <div class="file-input-wrapper">
                            <label for="avatarInput" class="file-upload-label">
                                <span class="file-upload-text">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</span>
                                <input type="file" name="avatar" id="avatarInput" accept="image/*" required>
                            </label>
                            <div class="file-requirements">
                                JPG, PNG (–º–∞–∫—Å. 2MB)
                            </div>
                        </div>
                        <button type="submit" class="avatar-submit-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                    </form>
                </div>
                <div class="avatar-modal-footer">
                    <a href="{{ url_for('logout') }}" class="logout-btn">–í—ã–π—Ç–∏</a>
                </div>
            </div>
        </div>
    {% else %}
        <div class="content-box" style="margin-top: 120px; max-width: 800px; margin-left: auto; margin-right: auto;">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Match!</h2>
            <p style="text-align: center;">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —è–∑—ã–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é –∫–∞—Ä—Ç–æ—á–µ–∫</p>
            <div class="tests-container" id="guestTestsContainer"></div>
        </div>

        <div class="auth-modal hidden" id="authModal">
            <div class="auth-modal-content">
                <span class="auth-close-btn" id="closeAuthBtn">&times;</span>
                <div class="auth-tabs">
                    <button class="auth-tab-btn active" data-tab="login">–í—Ö–æ–¥</button>
                    <button class="auth-tab-btn" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                <div class="auth-tab-content">
                    <div id="loginForm" class="auth-tab-pane active">
                        <div class="auth-form-container">
                            <form method="POST" action="{{ url_for('index') }}">
                                <div class="auth-form-group compact">
                                    <input type="text" name="username" placeholder="Email" required>
                                </div>
                                <div class="auth-form-group compact">
                                    <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                                </div>
                                <button type="submit" name="login" class="auth-submit-btn">–í–æ–π—Ç–∏</button>
                            </form>
                        </div>
                    </div>
                    <div id="registerForm" class="auth-tab-pane">
                        <div class="auth-form-container">
                            <form method="POST" action="{{ url_for('index') }}">
                                <div class="auth-form-group compact">
                                    <input type="text" name="username" placeholder="Email" required>
                                </div>
                                <div class="auth-form-group compact">
                                    <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                                </div>
                                <div class="auth-form-group compact">
                                    <input type="text" name="name" placeholder="–í–∞—à–µ –∏–º—è" required>
                                </div>
                                <button type="submit" name="register" class="auth-submit-btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>